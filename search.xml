<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>由源码泄露到RCE-[Mssql]</title>
      <link href="/2023/02/03/%5BMssql%5D-%E7%94%B1%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2%E5%88%B0RCE/"/>
      <url>/2023/02/03/%5BMssql%5D-%E7%94%B1%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2%E5%88%B0RCE/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Password error, please try again" data-whm="Password error, please try again">  <script id="hbeData" type="hbeData" data-hmacdigest="d7688d238d9786f1969aee6897b538c97d72c734764db132c4b0a0ffa4a61b36">deaacd5f427b337a2d760129011f3d11200a1b2da57d74d3a5e507694cbd91fd8753ffe4cd0918268cf9e1ec2b3d20b5ceea89e72a0da2ee6d369909bd72aa4a49a7a94901284921b56619a5ad74e19947710318daca6759e52de59eaa3708cd67b0dde3a47e133f7abe118f1052e399bc18ecafecd6434f3f812a64bfd2ec6d7461c51cae1dd467ea070aa7a1fd3e2b52f105dbe222eff67817f66bbaed82b8e3af0f1130b651cc6604334ed412adf6aacf6b0c2b38b80968633e17cac8456dd44c4e4111021d4cd07ad7de3f161efef028ff8c0969523e0638dabde6b456a87764524af5703b5e50911e2afcb6b5ee0034df4f8801e6eba8148d94c09e540ae6e82ac1751fb1bc35f5700c3520b71edb8c49af4bdd3689c483e3cd70f01d12ee5c1ee4c8df0273092ba92b63e3bb9ffb38dd9dc6ce66f0a9c8e98943e58741cbe7995f2ee38914c7ff3e34e954636bd0de283ed1d362bac1f3c24545cff14d67ecbe4ea6266912142378551bfbbf3cebf8b706900a33049957add40d391b2175714e3eb34aca7a5902e5ce177068a78c142a3e1b1740bc2168e24944642f3281f5e6fcc57a6223009111c43544d92424dd9298e470e1deebc2864b3701428f92186b5523d6a528325c69ba7a7a2aba25060050ca805764882f8bf6f4766fc4d7965016808620ba147df409fc891053a83fb5a2f3c3cd371db6476fa8f14520bc11e61051675638a94b2368e7e840c040565f796cd977d5412076cd035abff700904320f9573c3b6b9aef680ad36853e1ba0e1cffa0a76632b8ff356e953b83f2f3340be12a0c0012aab80f6a6aa814e88737c7d278f94d880284c08b7878faf9350a6e8e29d29b0dd0cca65cf76c5e832de39d3476aa39a403553700770504cfe25d3d2d9e11418dcb76d32b1a5aa0b905fceaa7503c0ae9075ec876d958e24c1350a6c1e53b42504ae6dc062e01102cef7d4a5ff9bde65004ec94c807fab83061e0412417c6514154b4b6209ffd221515b5e1459f3e42d9363951cbb8364467bfe7135c3b8b1e3e9664f03768f3abe873d6fe63ff2834595fbe024cbf1d4380479e2748ecfd9f54870bc8c49237660f939bc996cfd06c5341417df7256ba7d0f28e6bf8119c1aee1e66358b6ed03aefe06ab395cc8a823c7658cfc33a067d4470b5460aed6a1b46bb67d8252b4c6eeff3202a3ac5024b4bfb086246195688e8bb3c8a3f1182a529c23b7f9c6fd76c40f1ec80e5e20881ef696ba9a0fed2ecb6d382a0a087072b66718276eb422a0d905e62d2424415cc286dea3fc6fa48fa137f189254f8d2047c9b27245a436f826c3e41fc7bbc563d65b2687de9954b77b779448913085535c7e2a513b599ce329eba0a68d4cdc5972320af72badb7c3dd21064c5edf1d0e427c756a615a9e08330a2a624f854b56b6b51416e87e59cc407602def686151ae58cbc86eb6ee2ead25dacbaea978bf36ad38ca0c974d2df6bc7f46aaef3b0b13fc0649f2b52cd7db424d5e4df97b6f5355ee53c5c01ce1fc225cce312c19c64ade9cbda6875920ff082091f4eaf7851305a452646f950942261d42a4e40ae897bfd45cf43636c906b7ef4c5ae76ed5a9d96024dde9d4149c638b47e017346b5e5de431566c6da5175935adab7fd31b822c6d67120e43032683dddba44494d047059cbe855ac59c6a02bcb2937598d47460b1177f8cb4cc3f2e7fe97916be25cf4bb0da3daaf06c671cea8fe16e3a70b66501123c3633d0246454e24bbb62dc9fb75b00e6c08eea160423ac3c54539e343dcb41bbc7e8a6ae844a7e18444eea320c59b590678b0e37894b9bb847812cc382e93308ae4f76baa00f4d6d85e23544d7705e55e86aa41a9d6c280e8078cbe3f0572025e6eb07588b3ae202cf7e58ce32591a2df0e6c3311adf544eb0077feb9b8e9c8664a7afe784e2c5f185c85b7881a011f5b0a16d2155b6d124a4af004f204519b3d02ae7c476adf89a97326467237ac5dac2446917731f29e89b5028dfc485ffc50725cb82ab9f66a8d73d3a54f1f5f49b3466d142841304ea373f9f3fa1e7c277a6b869a146ea2ca77a5b7101c53e8c8c28f0bf097b109364fca540a6566e7fb3ceac8afc403498847cf0d942ab5d1f308f42b1533bf4a04e143baea0854ae739b314cd36485a2efb69ef9770d14ab966b015ec8a61fd4472cf8dfad7410d621f1c7367dd224c5a1ede0fa18c7a0450d1dfdf9cab019a855c41f86cc1046432e771970551d2d76f63cd9fcd33bb3a2d807a59009cca4fe269367c14d0686bbd6ec98cb0033a168ee4042b14602fde037bde701a90c1f19b1bfe04efe546d1ad584104901a5de2125c6551641ead5d71fb56fa40e705f7ce3fcb411a08de5c8498569279e269c3127e5e1e6640eeccfda230c0721de9ca60e11c90feacc1cb0beaf53bbf3a827caac49223d68104c08ff177e4b5f69754d0006ed7e910471035bb984c65c8caf592628a96b3d940a455205caef7250eb70a0862d9de18c48a2e54a0f163632da21a48bdbd75774de3b1cbdde806c0cc175131e604b253135bb56bcb30b5e083d801f1983f85288cb9fdbd76ccec1c7a96f7b04c58d0fb8a5adb509c8b25b3d2a7603d6f270460e33eb3e31ced967f06a52ac1a79371897659ce05db4040a056b182c8684f035f64638293a0d53cebf5eb4ee737bd21fa8ab9a51030eeed9f03f087313f0af820acaa0293ddf509046068fe6bff8977e753f9e52e0cea9b2e4d98e0b02e772c218f53a5b2381799ec844836daa1c7707eb0516342242ad0559cbdc0391e3674b4d9ff04782940b35c1dc8b07e675ff383b933fcfaf58fd8f7b89050a49b6a389d4116a3f6a07092c15dd4e0a5c132c9185ad641f763212abfdfda1ce640b4b9484d719569bc35e35d52b8f7bf861303e5f3cd399360220b15a73e39308b838704ecc40d74140ddcbd4a62876911159f39c1ab8b315c77db1f49a2908618b20f0d2219b9a2d63ba20b1d358eff215606fe2f47981d2c142a1b5175bac8e3489fb12994e08e4f4a674cf772344607451b02edc794fd6212b5ad64d77debce2a4d950d1888c45333833234fcd93a850a310ab7cde60e90d6676fe632dadb20b69936200b515b7d79032173813226b7c723f1d0e35dc34e6d794b45017bf4b1ccd9164001a5973ed55dcda8bdbeb9a0c0e720c397b84463e252d98fec3e900b35545bffb9b2ce3185f5390a35e8e1955a18123aeb076a809b3c9203286c468ee7051c3c9e149cd9cb0da8e055ba7cd0773fc4ba45cd4594172c703d880abbdfd48e22e1bc08d9a26649b110a83c546060b1f6031351c19dd97a2b939bb8f9e6e40aa0f81a546fc25503e4a64d71a9eea657f7395e86bf59875345cf66692b043f2bfb8d30b25097aca36683d88520cea82447fcb7ce6dd769bb1a01358b8a146465383c754e69ce96b31290b0e671dbd4c1e05d78489e37cd1944ed87c3ba48e9dea6c5ffdcc437fe1fdb25aa591f5132a385c078f81960b71f27904cf419401e629af9a2881a075ba87c3112710c2af05730c77d5e7c61a2a05c8266393d36fffb3eda7bc1c0d94560c360b5d93f0395e26e033c97f9dc138fce96cdf03e940e25e16d5654c575a9996213bef127609f70242df83274f88c9887d119c72fd3bae541103ed40c815344c85d171801eb7ce70f9cc8571bfabad2f3ce9c3970770806a762979f00d333e42968b1ed6931bb70b9d76730325de5b8f3aa4143a1ade2b1a77d25bb91c4fb0f378163262ba0e160d53aa0e555b3aa9a9a60e40d34b25552cfdcb2e3f88de239108595367bdea0f5b3bcd019a00fa6fc33d8c914f1895f9c9e82a0297ce2838981d4ff7a1507d2b24cb0f1c5119ea91b53046332cfcd36d89d429ca0a36d97ad36b93ebde52252e57eb24050f2dc7c95d1ed9061e6320c4b275abc62089932105616be26fc2cf8e038c66f9c2d1f3b1121b1f2980c1296dd3a287a12e45ec5cb48b09d5719fd78506fbe0faa6e1ef0465b69ef109c2b067007b0d4a46f81e11b7eb0096ea17f687a077b5cbee5598358eaaf84018f4b64954e444a9e4c18ba602b31175f018453435b4ca88259e45dc3b3ef574f09cbe35678ae102c936512f8eccaa8e1179af033b3d819afc96f86cea67d4c0853785fd4a3bfbce84cbb217b4bb1d1ccc039dfe2e66e144cb7f43cde691d4c2934631ae69182d250516405c0012d69f83bde7219992ffb04566d8b6dd2fcdd7478a3c7f263093984a3a7b931f5edeb5c181f5b584577f59f564ee6a7874817848f4ae4050be588e1873d7778595d8b4f9857b010e71376dd10cc91e32df45e408d3481489d1a990bbeb07bec9f7628f68ecefffbf80310f95e78df2840b03f1a349292dd9f3e2da8ccfd333b50d9eb48784185d4cce3582a20ef22e3a39c6165d1336f35816f8a960c3bb1b0cb5bf9db106ea13d1dfd571285a840e4959e4afc34d3c2fc01cc12b16cd43459c0b64590f65e36d169aa4f4be8494a947b84fd1de68582dd59e29cbf32e55ef100253fab6eff4d34ead252cc96e67a37f45a25e9dc83cde5f71b8cb95a31034b6235b051c638e48edda390adce89367d7600b432e3ce46edaceb09ddab9a44945c18bf01f767d458eef9b89211f78519a81ece0bfe9be7cecf5b4f6c2e0ce934cae40e76ff97a601cde4e16e6fd2092dc89e7e7c45075b512425e9df7872d22c4ff798e9d7d5735e0e7c4a2ef49169371ae956d0b1d87bfe3cf3acd500a194555322fb552260a3226f7f2aa494a664de068f97274e2c6f7c5725284348f7b58c7a3d1c09b4c04ef6a97f715cc186589a78061d4865a63bab26f34cd19846520c24ac90ab51e4ce6828cca69b961a3bac82dc3c5f18ee342d07b4d043cad65a59d4841bad474b270b852a5376df1677ebfb3ac52db94c8096ce0487c1b34f5e60c5f50501992dcb2dc3ffb2857541aadb4eaba009bc4cb0dc72bb334b741c26dd9dfd226ff9d0ae100daa0c414f605e147c535ca4abfb4d4497e6194337d1e1b183237b203444d2e5be7d36ba4d838c50f8075237291a2f0b64293e5685f1d4b7ca01d0d3f605eb8934c3660221330f7af299d3eb570cf33caa61702f878e9a10a3517d640997140b2b1275a78c9df0a9bc8d77a74de40c107cf8db1c183dadf016ffc59d4feb9a7ce2cb2ccbd99fff278fd829fdb14e5d3bbbdb7c3fd8484753310131d4db95e1023134862a9c6cb85d7ef8c4adbe5e12aead843a8eab90b4fafd7b37f640221d99cdc8bb1b3d8a6bee81765467105b4b7899ade353ce748a2bfb52f86fddf6f76d9f2970d6f722782d601f61b2572b40ca62532379fbca6697a90c7f09ecf5608faf2d4cfd33684fe9236e1ac353a61f086aa3ea7efdf6e039f87489b0197a3db628e09fb07f6e359856b4b4badbaea8e059704361af27726e5803fe0c21d06e76a63a430396478a1223f9966424ac5a9d959f7c749039fe182f4ce3ebdc0e7b42719528d25a44711874720f1c5304a012d168a79de094178ba3815968fe086f4d68c776c59b17001db1b4f89700793d66b4cad0013a3f8c806be10afc5cb9e9179120141a6935996f4f9e93521b2f3a1f8bf9be562c6857356a540716e24cba690e8a7b9614d1f129b5c46708da130f6731a4f84277f743a223930d7f53c363485a97d6f0e0062b0f65d02ddfb9d458cb79c31033a34b004efa7eaa9f937b3cea39ffe0673f8e47740e6c24588659a16c45c8ba69c228e7fc7cef6325f337b7969f2abe3d0a9d48f8976d7d0bf9e61f0a79c8b0c97b6d04cd2a556d6c343d55d7bbb9da751f2554801a8452346e552b5ac3c41157b97ac7ad501ba30b1d4f362b97d52f69d6e130487981a3f02c7a5d7e486278e0d3513f148279d78b515d5fd80e68c3c71697d982555922322f3b77bb0a44ff80f3d8af310f8c2497336976439a0bda9b2975b327f1143882dd278c24c24411fd0d82a883d338c769322478788a3036799d44feb831a725249dcf71ac0149de8bb9ed1d3d1963beb481eb6127b1be25592b81f31ed7847332ac0dc0c2feaca7e282c6e25064974cdaf7b406b80574bc8323e2d076c301226dc69434d5bcfe1d83bce1aaecbb631ab80e46a7576abc1fe629e4a672c38e833d8cf97f78280128effe151f1346904f82d7a1d0c4ba366420c4951020a073943667d5eb128378ddbda86b87d79058e1132482ba11683f1fb1a3651a1f61f831165e3d38ad03dfef08c7f50d747c98906182625b8e930deb2b258bc22da8ebed7eb029b5570c03988f6c467d923718debaa003ea61884cda0485a6af3f8fa42f6a8a9b406574e7e2812e764a6a35887f3e4def3ab4713f77a9881cc0c6dc57157cf07c65ce7292b28ef18d113d68ec9e71430307fc39f336519edfea89443ed24a51c206c6c8218780cbd8a6cd1d6c89a940d39bdb83c0f22f350e3139b73773a1d61557387f18548911099324683ea81831882417cc5234226af196345f359869e40f12a165b4f5f2a9259460dbbc3630763f02b02f5633a6a394d4b8d75ec619002459e2bcb5136854165a6f77191b245672068b867f409e94288f826fff33c6eafa203338650a001e6c42a3f924ae7118dcfdbfdba9faca08bfbd3926d1940a0daa493fd58564c09a84cb64d4b52a44ec52320730001c8de40d823a43d092e2ccd203925d061cd3a0080813e2b07b419c7d065cfbed1879d2f840ac01f6ee24b3ad8bdbc7c86a99b31fd626e5159282644ff4a6d5fbaff5b60f5c48fb05a5362f0547114259f262c9ab84ce9738c32f9e06e190514221ecfd7ed183b902b32d996a59f1f61b58b6699c7bca51ba1eb499f3568e52d46cd4742b88a65bc8b70dae4b765270ea499d53e67e6f1e036bc294f1195cfc6c7889fc648681baff08df01783b1217ab61710bcabc0d071177974c01fba71f885f8809b681663ed4a67c88714bf8e85b8104029dc97e3515b3d447d669d7ce5018fec9f2e52633f436de3dee36f5dad8e3da4e62683dc88525c19aef7ec617a7381e67376c6a89a14a222682b2c2628c5348acacfcd44a639666ce5ecfbf0995a7a36394c748e5bb0a86d4e2da98dadc68a7a6a83e32d425e83ffa3c0a9a7216cfd15a791ff48ff01bd0eec5611b814f2f3ca94bb5c3c89b6166ae27c845057b94cc734e854df160c4f8f4f6ec40db51c98188acb73906eda8cea0424fbeb51aa39f0027e4ad6cca7d702a175ef640a093d649f929fe6816005d809abc0c182a545f1d2922c574c93dd2f369ab59510d4efa067edba1638b2df3fbef10b94bee507b74df11788093ebd53b7ffe019f56bfb0ea1c4c1ded3f23e89a302eb5c0e7e251508e42065d560b4686fd8db8ccef19156598794601d56e5f2184de306dfe42948dfd74d816b59fea7684a8c5247fe49d7e9fdd3094bb9637e995f08c98b005c7d1218f031407c35ad1bf7db32cd97aa7c69e75ce4587b68f5d52fd951a4fb756659dc09580d753ffafc71600e5744d91f79bd112c13a0e48368cddd4e70181c9ed23c0996dfb393dc3fba405daa64d7fd22ac49139cb259cb46b1e96fe9a09968a95a4b5febbecd89a95bcfe0af96cdaa7bab2c4592358c070a5080bbe7445cccb13ef60d0c8530c3c1b0e54246b9651edc273c8b3b7d75f3e21023b53c4e9506044f83694a8cc72d33dee00b3acc5b7b9a0efde10c420b053232401076fd5c72a62441b43977f9abe60e4cfb61659673d3beca7a3e4f19950b6f0c951ff16e6ca1d50e3c2abb05f5738c792cd1a6172527594477eb08e5eb8922e12a9c0ad97cca073efbd6bfb778cb9bdad518d3c86be658e40501128b5e3c9684681f350a929c67800448f5f1817ffc0cffef9f35c3b0aaa701d6ad52684b408d8ec32e28f626ca7d10339ea208b3b9909691b00cfb3ebae806ea02c2c689898a3d8039690cdad805ccc277ca2c1a4d0f237c31138736b831415821409fc6c26ba6d1580eabaa4051a7d9e2f833d93b4d31447d05312a58278c9d79ef6b8679362bf1440c172ce2269aab4c1e48f680aeac4ae369505fce5d48611aff88dedb162a8105ca55c83a9528f2de03f0ba607f1adc626c05a47a08ebc206372d4045eead9ce1f774ac0d58083b55a7d3db08f0ea843335690bac31120666b82115ab79970fa68d41fb9e1c2de3e2c7a78db211cabe44f84e15b21815a1e64f35389d4963dfc26f026ce055b453f64b7260b1f00669b383065d29628596be5484214c40b3183193b44d8f2372666fbb1a39bc82ab252c937023edd6e7f9c7e368a58008d4a1afc8372f85a2f8975d91c80623b74570044593fb1a9fa149b8cb979fb323a9ac324227d32fd34576566a210d4f1113a8627606195be1f2bcc736c2c5400f6f210e87f63851998b5a5c2fd052bf0c7c73c6b2e1f416382a1384faef5217baaea3be68c16dfaa2a58801f0fea29302416834eae0b4203acc919b6f39dc784a44dc919d7b459905f0b2418d0654c9996a1cda609fb97646f41f39e7eb481848204c6d620afa63d2643803f0d3ce9d75de32432b97b8d2de8deb3a207df615156be938faf1b34c7a18590227fea3be317000623ec3c359694a7df95fd392a80b0ee095c1d76e0e407429c66a1a5c6ecf39f4ef98858bf6d6563dcd0a5a2e8eef9b8c9df4e47e08df5b83bab01788959e8c1f28c9ff76cc766da2b5a32b0026f5096c2893027219b51de3fdc3dfe12e1bbea75d917e4a1193eb01ec0a1dacf97171e0839fd1a05526b9286d5eef1a03b55261df4a8e875ee594cf0cf1dfc9a35927f2bd51c9432cc6be94734f578b8b88262d49450eaa6357e514e369600c589f072789788de9250d4d21fddfee061dbe8dc13773096cd1689db5e7c7a0ab50f6ebd64824a8c5fbef453351fc7b2726e210f96e8ac906ac5ccd7786255e857f98f617c5b9993536690dad9a8bc80bdcdd04cb236f4ae06b9d1d37d5eaf593d78714a66bf2ab51ef582d5b3d19bd85c69218227c85ac150d9b0bd8fd76db03a20e67fe51537a75958e047503b4ae2ccc8709715d0233794e5c19202b3b14115cb41a3b2d8416bb0cc03630563d498af490961f31cbeb8765bd1ab3798e0f59be76a2d7fcf9d7d46c24960f54a834e8ee227f91b1bfa2018ee7f6a4d511b25eeadd7944ccf7d7363dff4384d27c4d64f684135b3693669866d3b4df9dbece851cf6cb8de82eac8c7c185fd5bc46f83a2760760265886330ea6cdcaf4c17c25437c64cdb0bd79e0b572de3deb28e44c8d43bdebcbe4837b25006e88c5e4ac6e6480f79ff0de40173ef0261af4ffcd761d9fbbde4c4b5d6331debea6658cfe201a8ee2a998528bda6a01720381c0f87ad81989e8f44202e87148758a8b0b470de6c2a6263b768f466b287972db2f2b1c767bc3dc507e4cf8bd39610ffb04f1d0ac5232a22611b7ce469a2a60e79a1af0800b234bf022d9c0fd89e2ed220d2b6bef2ca932303ac779805ff46ea9f3fb2c70a1e53c82dcd4299d8daddfb51312f27151f5bfc27546d737596d3f60273df76d31ef22f4b31ab879607bb0459bfada2ee560fe3127f4adaab084a8c1ad993445e829452192827347feb0c9ec9fb4792c81a517553afa6f2d8dd72e0993b005f1b499268b44174049d4922aca4c879a8e578920b75dc15921b4c1c54b492184596873e35451f2d2136d019f35d6baf50cb1a8859a7b232a4691c28131a1be4b208a179a62bf0b4f6e21ae31caeaf5fc0a4433e419f5558eebb88a4d2f717eda7b2b113fc44f6c0fd14c2ba827c5e49a5a44593ddbc5f908bed5cdd27664ba1c8eead80690b3290174249104b9451e1ff90ca14cdec6f3e9485e528924b7a7f1952138797830ed9e6672e1f7f5e5bde9888c9800f777770bc1cffe1485efff0baac527f309f9f6a10c40c5647cd7733b963e242f5e89ab0592b566574459bd6d410c0d10928d25d4fa925157d42b6919f37721a003d112b46ad78277fc773f069a6ce24d4ef4260cd88293c87d2b2cb4eea2ce374f8fa907b0bcb7de0f8780d37c0f622d74528637671887b5e118dfe41c808e461b1b44c03fdd4b04547209361291b148609dd046c72fb7cdf19e2619488d067edaaeb3885818c7e3ac4c5e80b24d226567816e803e7be636ac7f7c4854d0d2530f9e16b63a1dad08dfcc89676c7f2fb177e7e55e26f09a3fcf0443bd01c1e857fe7ce224ea707fb0eba50d41a43fcd1cfeb30ae209ce43f053bee3bd23d9edb0c6d73e265e5ab6504a19f670feb7b61afb3e0e43b4fff7337486c21e1a555716a1b2e711e10aedeedfff0450cd2fab4d74fbeadb7f10921f3cbe34064065223412a89aa035488abb26a1cecb13574e4830b9fab51110594a466c5875456c7653f226bbc1353d7f9f1cba0c283ffc9bcb6e8173db2cca417d2e95638e02f8e7e6a85d8ecbbd0f40ca15d46f4be8a4a58b19ef8e7281d98fb90c1ad110770c907e2882ca80e96442130bc0cbc964057448867a8b591e2c8fa9cba10abcf70ab2e0091f7562e26f61a86c564adb28e5b53b3ec1cf7eb52f002ec958e4d0700f4a03d5d62150ae34f025854edf97dabe2dcb366702e15162ca37dddcddda755c0c0c4a1cabae31437eda9046a7136f0ab6a8ba294ca2b0612125dce2baa08e628649f07d77401cda2eaa19e84074d487af0f4d9332e4d44bd4d3073cef2e7a8e578a5399530f8fd65d24e6b70a78a74dd7c91c426f35cb8ce30a361bcc3b4c40e0091c91db02e83f10059b95b9e4e1c638d4eaed86102ebe311bb73afdbff8b77400b94691994f872a96d1f2602ebbce9efcc9663f6d65d9d8c340b4e2937d00af73b1a566e8c1057111d818d995dcd363328c7cf720d38f5f8fc0b0a8c226258e4a7739060ac385313ea5bc393aa8d99f812995aa75c6c70a7dd206d10285390268f8bd7379127d867ffe1bf2d4f8eb5709760c69f06395dc128c6022137bbb149815bebe1e449aac655734f4ef84f72040e92073c95192f14fc06aa8932686f074599ced179e4a01dd9c6e2ba9c9c27202222f42390536f36f45f9343c6ff373109fe8b99aa9efff3d22b5b62c9523ea75851e26d4cb8d5706d4c0ae9d221f4369bb61800b54f8a8c415a3abfa8c8d0f1f49ffa053c6a29a8c160af59b20f2c8063df30c904a338504c64807f94e7ae74c51c700612ad62ba8e916552c8eb663c95615c4416cce01343741da9e53efb36631cff50bb95d033479ce75d9378976fdef325ec20453664dc0c07c6516ccbfd3d368e3c9a9ca4da55394eed6c1133cc54b2df506a0cbe5f452e2d62fa9fbe780a726fc166cff81e3b0fc87f6fad6cea7c33ee42a887380532b276d3d2e0906f1996e45832b2daa4622a83bdac56648898f27a1c8744012e6e05cd391cae9918b2968f6b343863efb1f090fe8bfb9813db50fac7b44205d616363745ae81d488f5314a5a176b9281ea049da1fd43e847e535476d019c2a27182c789780af84f9940de3f15507473da8b1ca71038f450b46f895434a18954d6b58c91e2e78161062c5b8d8da17dbe54a455ff2bf0db053333f916f3cd995e0d7d7b7af8b062ca4c0cfc09ba59213aab37f1f049e77371ae903be08191561c80bf0975e3d6b377de9a205094bfc4b62a550d676c08551aecf780eb43313e15b4f3a7636562f43df4a5b86aa3ba73557fefc544385784b9debc2d4817461b96d3fb871e62c4dfa939fe312d5c48f516a357bb8867d0a1f4ead853a854d4475fc429ace2340ec664021245f406c7de6d7bd2f72d114c4b8c764b96f219cb81672a6fe961803903e8ea9c74ec2aff55f718cdbd39701a6ef24844e65300a58bd6d56226dd27348d3bfe84f61633785eee0d962071af347e8f355621ff38ecadcae4eb2856270a6db2b85e57802a68e7e18df760f360395e394e983d4ee82c6d588c4cc117d51ce019c3315efe9981d8427b51768e06a10c9621d965f1a1306f789bcd786b9e6851abb2e8b820b3f5f033445b6fa4c8afcc897cc986350a67fe40445766c0d3a8feaa5b81a23af5e2f8597cb3a0515858cc3cc6b3ee3c445219ebaecceda5fedda128320922ce6d7a3aa256e57672da343922146f4e4a7440bfdd9bdb19bde44cdec8a205ae09560ad9da75c087ab40f860f9eed427d0425203873c38df9a7b94cb5b312b19c294e754f5ebcca2e8361edef0ec01c0965f1fa6fcaace371d47ec6a4602b9e58e325942a9a5d182be953a33e825e40e281cf8b7a3fa34ef68f7fb6bb718f834463ad470a64ce1caa0e2f65722e98ea8ddca3cb1a53bf17ef5c5087932f174d259c5e86119a833a54fd4b1a96810908b443b381aefb7b363bc0d75f45532d2ec3b5faa2a951e791d1e9999642139f7f19ba4f073b1eb5c8c0e84d51e2e32c88aa5d03aa29b5018bfe4de0cbcf627873b55079fe18eb2fcaeab68101bffe6eb81ffd28894b83bf298f84e101fe1e2f2e7b7f72d8f2c2e3c275cf6f2a2a08647cb0fb78cd598dbc3e132f404c0717bf3457070fa36f5de0998049e9091df4f97188ecccdd5e8d9143121f2147abebccc4a00e534eb6eab6d55e86b858f9efdd6f8188f4aa30fe8a3cde56629148589cd0686803703bda35ba168091198b96168a3687ea8794897941fa18b8425a9e8e4b064a054a2f027c2b8b0021c4c0dba12ac1e61b09b7b4539093cb0a8f02151d76fba07025cf16040f92c01f650d06204809a7db6cead9aeeb1b6987b7e7b23bb91db38fe3ed006602da6519e891c3a41bc50b6f1a3544601a5bf65be6c199c616f65f5d9ea4822421c7858519a16b5b6e95b50dff69f56f93905a9ac57309d5cbfc000aa9c2e092a51ec87f2cccb1864ca987cdff9a6e5945b0df605cd629db225a5cc50481d427c42797d7bf298c1279595293b8e754e35f20a9330334c64229fe4e3defae9979b961ecf59469b57a95a4238111b3362a56b7404c0453f3b2b91f91150ed34a31a175b783ed5cda8ea2deedc5ca61286adb2d5fecb4c514cb9357bbc07565bf63f9ac1cf119bad6fa6cd7f7b06a43f9f2f7446b38b2fb569450e5b849e291e68dd01b1d53fbaa926cc2d02302985efc2a641a06e16545b9b01034cb6c4e538291573a4afbf4550443a4688618c432e0142e7f6889f11e7fd87ce31a2850f9e8681b143cd4c6d8396ab9218f31de8237a8ff59afe8e20324af6c0b4fdc1dc6a7487ed3497bea4bde361bd314167515595357c8f501f6b2bf710e24204fb59236b24b95248bd8cd99b9ba95cf4c555edb2755aa42b1e773b85d08be59a66357fa0a556d17e18f1fd745453a4623a5e929cfde8b04d1fb6758d0719cabab5b2e6c205eb1e77825076d8565a8bc176ae457cd4555d1647b15dbfbaf3e469517beb7bb72b49ba8189e55f91da977d52994ee5edbc53fed7151754a676142436a99957b7947981e449d9c4c56a33db6b751a7870b0d58324f7c3af6bb1230e17a2519a4d17dd4e3804187375a8383ae2c1ec5751647f5e0cd0722413ff0999ffd4565bb7fe81ae556e003f06ffcb46053343f05b561813960a8f9546985cb5dff98a063373874c499524ebf0535f45d7e954f47d228341610cb647216021ab43011dbcb452f0442374cce3cbbee535c1bd877a81d25771e21bdc775cb8b9f67fb68ff0fb1b5112fb0b1b092c0e4a0ddd1ed448f8f8789cefa9bccedb278b3a083921cc3f3e25073aec6b13d54d6f20fea488fcb5c50811a9c68b668ec810186fa86d3928392982b3b95d0d6dd4514436a29fa9d79eec231cae64400f22823e43ae1114e8e472b38036aee396ecae5fec6b46c556f8e1cc8a2ef251d17f4870ab3de5d8da70062c66124a95fa2b453ac2bbd74fbddad5da8e53c5776ae1785ca3fe9cac186a3ec063564f1b96871b17acb81bec6c3e1bac52a6a8f40da24c84ce1655b3e683f4ec901630c61efe9b62e27afab1805e6b640a7ac052025e550acf148178e442d78c3983bee7ff2e38205e905d12632074c0247ba70732421934412fb88de62cac4471f3034442112e176b1f70752025e643130a28a8d253ed02d5b19cd30a97f45759dc862d6f5bf25dd653a7704c03a9a6fd74fe4c2aab46e8a4893e41c8dd79b71767bc9311041aa46daea20c73d7d7857f1ad8fafa825ade1c396a29a6fe0085ae5fce6f4c30dc625a4152647cf59f93d7749922cc8e9b3a215a098a6f6fb04d03901376aac0a4352fb6ed79e31f2e567b434621b4e9f822793d8afd884fdda09be7d11aa5680e677cef2be215e2809e38c8fec9421c18f2fef44811cd705b0dc073c4ea7ec91d73f8fa3cc6621555cc7ca37b1d53165fa43cf1edc69c212643e15798ff70e9d0f813441a3331518e3fcb93c3194e6e6c4aaa1d0b4fab5385e71ad3553a28de1699a4f10f987fab34d53affce8daf81f01da622d42aeeeba51bb76c1eb6fbea0d119eb367a12339dc69b0fb6863f2d08a9f77194c573f24381ad9d1b2a52806f9f12f89fb2056334e1b72e879810cea543ba6a0760101dbd98c7fade1997ff97702b13a3fec07a4573dd29563f69bdcf86c750012ac824e127a3b35de66f5658c2b7ad1b0721aeec250d403b64b9abb50a74b751c27e38f4df8959387c2e943241d0d0fccbb173fed8cbb6e9dcbe9e1341a5883d4c93f7953593affcad0dfde08a54c99be852bc80d501fd2852a0626bc1730b6b4c2e8c274c61f03a032e99e69432fc3200bd5f62858ae4a34076ab25c21bf3e9d4e94ca878f5e2c2ace8410c46495a000c947f492c7d1987fe7431df15b8def753b3315645f708a072e2720fbe19c488fba8637085828b05131ff27f0ff18eb0c837e9b429f18b9a574ce4d4adafe3b931a0c87c7a1caf7592e70c1586857fc30ecef656739d0846d8d0e764417b3f0e492c5379c6e7d3f48f809787841952f80dca5bc6834b05d72996a75b0d0f0aeaf7edcc4f52d23e56e0d2e877a5be2179c7397b2c15d35bfeea6ad4a3789c4bf5d1b9579f7f3a6cac8315cbe861595f07c54250c20fcf935a488ca8d4bf40aa7174e06f3f52921ee734aebd378cb7b80810586f8fbc0ca991c1f835c964714432ccefd6b910b47ee55d891ba2205e716fda05b449a320833cf0ba6c83e828d8428ecf413777b234068884c609ccc3ea2fbfa24168c3bbdd230a2f50a68258599908523320d4ac0b9622f5aabd6feef1a480ceb14f0c95aa730e8a4e284c7d5f5a13fa112e31aa1adfaa766d3fc6c4ab2dcf440e0314177e99fa6245eae0ddd5bbc19c4ede76ab08b139ca0387ce3ce58a9aef26851c829d54fb564c1fa204d45ffadb110db1cb813b31bb3f5c1b526194812d9224fc01a1a7c02efb8a4365d438194b363ace74d07c1ed8512b98711bc5a670ea6cd07a6ae72c3a25989a673d0f4504f5b149d844599c8c9da14c815e9efe5b751a2536dbc4d15d4fa15892b09493ca31ab0f7a11229dab53503560aeb5bbc2c3104e1da71e1c05bc2f336cc5f737a96d7244ee0febf6c02be6c948e61e8e450aae59d52dd778eb301ff40184283eab250afee0654c182b25dd09437f3111365ff7df217cb4a07450aa39635d57ca6ed912f5fbd973a44de0a86830d788fede95588406af64f5315d8c1c5b4014c1384359d1595dcc60651433f8a663fde4d71dbac07efedcd3dda8b1e3d88bce9c0ccc96e93036b54c961385e1281680712a6d8bfa0d23733a868da3051988791a5cd4781f830b667ee6c989800a735fd506603522bdb8e330df21ec02c0d791a41c143f1845946e81da664574ed339b46a7e0af95a84af46f153685a81e441c25f6fc89d4bcaea759d08584cc0b21f40739ec934dd670f86479e8fd745c680fb0ced39cbdd6b917ba85e31d6775a69af55d20ce7409f684221966fc90912bc961bbbb7e4d4f31e75f745482f7719a5428169b64ea694e87064b96e026526a36d233111ffb2294236717264c3e3eedca8d2385cba3083ecce93afa2654a228ee9e6c213f07fc96472fd04ca542f2631dddb15c7069bfd86bd16a8644fd143610cf26e54c61fcb0563a25b1ca3cd82b14608e7838fd3797736c5ff43155a6c6b151afd834b54e8d5977c1bae0d1c7151f2c577ac1d2501dba3fd867ad5ef7ad857f918daaf5aa51ec520ea7d1b9c42cc8bd0b42391c254f821f4f9b6deb61ed4aa92d3f5d3944a36bf9a53c3b837b1b84887a84c9cf14ea8db13e0c1c2cf71ff1b0a97d869117f5122e32db3898c455fd660b2c66ff9e96b95a812770fc8b77b80fa25a873743eab9299d3f8b38e859e8a7928b8f843184e01944eba0e14782969dabff11e29f47956b40f54a2bdddc86c34b04fb523b4e4c9a7e8ac0b7886386a7d40edcd6efe3187560eaf7130062f2f6430036352b1f510b4cac755da3603249c108a270791bd9b77da95c4129978a2a5771370e60f4ac54022b2636e77c7d8b1e069d51823ce33c96842d56b6945697f2f807ec84afd2b722c291f246f7f4c40c113878b2cbc2876a3b5dd2af05cc1d6c4726d3871072e7e87daa0aaa79e41c3e3ff5b42404758fef2675b1f8064cd60b2b41fcc36792c82f646bfec5101f7fe140395a49987ec217023442b69fd578ef02b7334ca99b6833f61febcb3cfb5f64b7721acb762f08d8711ebc421e7d2ba990916b8e53d85ac97c43fd7e37fbc366a80b1c16a44bec81c32ef665d78d5d30413d2fa3ea67f03ae3e3bec51648173a3a2d8cb9df2c6ea383af0d6d88b45bd5ca1dc1963ef11100a5e8f2763e32ddea91f45137e1dd666217629f20b0de21cba16c2bb5b997447e2b00e9fdc809ec5c68d4be4b8d5ca221edee25fe4381c7bd3070741e955d73e8344dfd090cba585fc37a630a9a3728166100d6b0b0253c19b699c21991488b7dbedc8898e176ab84f6f233a6e6a0af77e26cbe42bc0e826c37819780f9d072d25f1ff903cfdef5868a7b4e80bd8055996cd5f5006cd74ee1bcda095edf6a5e4c6659ed092640674a78f90da5112be06e846606e15e78c37ab60ef7862fd5b4ef93e8bd49ed783b941c5093b99a21a521f35a48ac9d0a386295cd5c8bb67e1fa99a9a84890fdff262144122a78e8769edae6bb3bac030435040cc1c9eae8243633f91f4f080d682607716ee593f15f0eb73eaa96222010d382a16042809bcd970c54304be44ee11bfeef2aff3cfcca480676f1550283becacbf90c33d21868111f6336ad768d72104751ba1bad8fe67203df5679665b15418886c0cbffc52335fe50e954f08d9c7c93f564754a41c61ec4a247722e89438bc8ece1ff17f615c26c2c9d1cbcd71e1348e9fdec3ac984cfd1875e66793977a5df0c7b23d4d5bddf5bed3b1eaeb4bb49e6c24d59d430e809655e3e60189631af9eb4d2efc89ce5b864067ccc853ec536fe2e38305d95cbd602e36830b4154093e079f71ce52afa25736a1b4ac505eaeef0cf264f608ab259416f7de79c3cb1197652366ebc349721e6baea30fb48144bbe547175c3270e00b15caee4607a6a1519e0d35f1d80066ab962daa8f589955571521ee0314e74e4a0725695f495bdace92d9639e65398b01ef8a23fc3bd138c3680e8ba7116b2da157521ac06aa446467a2ddb366baddcf9625bb497dbe026f6a0f28cfa6193a88aec5a265045cb3ea0eee7f9d7ed2ee0c397bfca6892b908b53bfc3bad2639c6b28a0c316f895ce6e99152bcd92aef6d67be47846c71afa9068c7b0e27657e58818b3d32d1afe0261c9fce8c06166e6fc7e98546c3b2dbf00f27c7d32dfbcfa6cb95e492d450f1757868d2545e485c1b17d44b325f23f67b4aa337bea19cf43aef136ca643f9154a7cd95bc6cadfd648cb04418d06c26677ed388c70eec40e046fafa2325fb816c08a1bec1addbfd6110119e7a1bfc3858eff351b9d607074b2ea0b9ef993b53ea829aaab416a5216bfef419f3c8d452e615041ea35be25a2da6950b5a8e95b88f76c9997bba03c151010466dacd193ce3e302c97389d8f0c961af18ae856d9f6ff6289b7dfd701f14188fe8efd10204925235bbfb76449d1026795d5922a0f67b992993c5e9821d73d9b9798426139ec33bfc4dfa96e4e5ad2c7b785f83244a6d8ea20a3c6d9034d3f2742516c76a83fcad370827200bc170e13f9dde007db026c08fc20c39b91af3258488b7c95b346db86bfdd6ec86a60cd5ba0baa73261c817cc7fddfe319cb2728cb28ddc650fb0e9344aa42a4a1b695467d61877997675af3cbba53730bc190a291db6242d33e3f0ad20fe0c59aa1be23b28a69abd6ccb208f7cabfa7b89dec1c52c96115d40ac108eb5f777e0af8015677322b19d386f65ab8c564c9930aea2dcc33875b5f9e10f6d39d1dc80253ee1d511ee1c7548dd7a37fbf6b73499ad1ee3a1ff216bb3bf0ea4327c5f8f249d5aabda0c5364ba91b23c29eb771ddd54e2f18092d5d5287ce2409266c4a5cd18a7ba1320b74bc5bb17be6ca4044c30442ed0cd6f3cff27f2223f669f48e7927c933207ad9eec5a83cbbc091452f60cea57b511ee993a19cc84f9ba8db31da0881e749b84ec4ee1ccd3cf346dce6fa12f3765eecfd2a99ff8f2e5f3995c3cb7080f6f7de127f52e2750b28d2c8a3321fc63588f4d803f403ac5db241ca6783036d9a67b529df25c5f370d9c79626fef5cad17a03efb2075a4ee9eaa251afb0f85460f5fb552a6ead375f64061bb7237058564737ee9dcef5077d935e7594d9ffff06ddfcf5535e8d3f00ee4d78a70f0551a469b290af7b6c921a86ddb4108595bf6050379ba9c97ac904b5a5804dacd3c9b81c65b839db69d8dad438915a71c27df5bbbcbba6338629796f77121866dc1248af60989d8beb7c7599e3cd29b7c92a108c36b4c8cb20f9af7f321b2423fffdb48bbae2e7406bd5ed1c2c97570d5a877246a9220f59b9791c7a3d31f7c146b8ed6d9ddee87541a5c2c88bc6220da5b9511f8bfc2572eeafe26097adfc0cbaa53413dfc7db9e5dbb0361d01d82aa12a97d53b660e1a8df15e6289712de2fc56633c4e96dac708b058a214091b0946a3e090097c906ea7008f761d5e681eeed120f95114882e88d4121bebbba84c6699a7f1f898007687f39e4e4856603278d50fe3aa0933856b0279f5111206fe95ee9a257e6aeac57bce1401bbb7ed9fb970a5cfdd3ad2dea2800a5ab543c240725c0d80f3cb235dff10db1dea3748cc9b0386d2e789d752c7f817fa1cec18c400b27aa584014b9c584bf050c72c60e8429b8c03d9938088f94a7d77182540812547a3652a131ed1b3085b23d9cd517ab6212896bbb6f9ba3896debc54fda379ba1da63aa45847ca8ed5f5fa34d125823305bced7efda606f09c919e4dcba84b340ae2c495fcfc6336126ae31b1666f3ff86b6b339e5f3074f2360cc18a72ad4a6cdec603fbdc0664200058fd5504ee444544556395c5cd7fd28f56543dd37521716bee1dcc9aa9961c6c4ee3f557ab0646cff0ef2a6a834e49857a1400ef33cc4aed6d7aa0baa3be7e6fc15e0b15f9c91e8ef4e9c417823e6c3b5f64ef6dab98a2a8609857d31d7cfb8db6739c3cc805755be71604cb237b8ad82bc5443af0a86ae1609199819659953099b8b7324d1a3fa1cff64e8b73849f509e79e8eff96b1882a2aa97de593cd7e7a2fc6de76a6e928ff57fb78fd471633a32e4940287b710a36f2cf1103e1e6a08f8686595832e6cd6680e2d568bf4bc3149ebd1e2b9134aa8d10a253fa31ea75f9b661d478f140e27f9ffbf4bdfaa1f4fde2f3918c18ebe2d2e451fa6927988bfb97f45beca9a06b058e65ab4c92f4cd560c5d29392721f3a82a91804e6bbfc6757150c72555d3ac7dcae50cad8c461d1f48e5cbc0c80c6334ccc3eeea1883b66030452e8d0ed326241299b9c18bec08fe006612d0871b70867d7db532cae7b6346b42945b01275ee3c77f10ef39035c9bc19616b3fce1be056def94b04ba2ece155ad0700cfd0730b144a17408a087740a7f225d4c13664bb7d1b30b7014893d4dc3581eeae2c1f89820f95d3f46fb611b87dc08e472f95d11285555deab4bffa2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-wave">      <input class="hbe hbe-input-field hbe-input-field-wave" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-wave" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-wave">Please input a password</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-wave" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Thinkphp3.2.3-[代码审计]</title>
      <link href="/2019/05/03/Thinkphp3.2.3-%5B%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%5D/"/>
      <url>/2019/05/03/Thinkphp3.2.3-%5B%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%5D/</url>
      
        <content type="html"><![CDATA[<h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="0x00-为什么要使用框架"><a href="#0x00-为什么要使用框架" class="headerlink" title="0x00:为什么要使用框架"></a>0x00:为什么要使用框架</h3><blockquote><p>使用框架相当于别人已经帮助完成一些基础工作，开发者只需要集中精力在系统的业务逻辑设计上即可。而且相较于原生代码开发更稳定、安全、易扩展。</p></blockquote><h3 id="0x01-TP3-2-3程序目录结构"><a href="#0x01-TP3-2-3程序目录结构" class="headerlink" title="0x01:TP3.2.3程序目录结构"></a>0x01:TP3.2.3程序目录结构</h3><ul><li>入口文件（应用对外提供的接口）</li><li>核心框架目录</li><li>模块集合（<code>Common</code>模块优先于其他模块执行）</li><li>缓存目录（<code>./Application/Runtime</code>）</li><li>公共资源目录（<code>./Public</code>）</li></ul><p>更详细的可以看官方手册上描述的：</p><p>@<a href="http://document.thinkphp.cn/manual_3_2.html#directory_structure">http://document.thinkphp.cn/manual_3_2.html#directory_structure</a></p><h3 id="0x02-MVC分层架构"><a href="#0x02-MVC分层架构" class="headerlink" title="0x02:MVC分层架构"></a>0x02:MVC分层架构</h3><ul><li>控制器（<code>Controller</code>）：负责用户请求的调度和处理业务逻辑</li><li>模型（<code>Model</code>）：负责业务数据的处理和与数据库的交互</li><li>视图（<code>View</code>）：提供了展示数据的各种方式</li></ul><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008785.png" alt="请添加图片描述"></p><h3 id="0x03-模板渲染-amp-入口绑定"><a href="#0x03-模板渲染-amp-入口绑定" class="headerlink" title="0x03:模板渲染&amp;入口绑定"></a>0x03:模板渲染&amp;入口绑定</h3><p>在TP3.2.3模板中先建立一个Admin文件夹，内容及文件夹名称Copy前端文件夹Home即可</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008212.png" alt="请添加图片描述"></p><p>如果想要更改默认首页内容，在<code>Application\Admin\Controller\IndexController.class.php</code> （<strong>控制器</strong>）进行修改</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008999.png" alt="在这里插入图片描述"></p><p>在开发时一般后台所使用的Public文件夹是独立开的，因此这里后台也就需要更改一下默认的Public文件夹，需要先在应用入口文件中定义应用目录</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008679.png" alt="在这里插入图片描述"></p><p>然后在<code>Admin\Conf\config.php</code>处进行配置</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008603.png" alt="在这里插入图片描述"></p><p>最后将<code>JS/CSS/HTML</code> （<strong>视图</strong>）文件进行引入，修改路径即可成功访问</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008890.png" alt="在这里插入图片描述"></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008817.png" alt="在这里插入图片描述"></p><p>除此之外，还是有很多知识是没有接触到的，上面控制器中代码有<strong>M，D，U，I</strong>这些方法，具体功能参考大师傅的文章：</p><p>@<a href="https://www.cnblogs.com/kenshinobiy/p/9165662.html">https://www.cnblogs.com/kenshinobiy/p/9165662.html</a></p><p>代码则位于<code>Thinkphp/Common/functions.php</code> </p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008892.png" alt="请添加图片描述"></p><p>例如 <code>I</code>方法主要用于更加方便和安全的获取系统输入变量，用法如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">I</span>(<span class="string">&#x27;get.id&#x27;</span>); &lt;==&gt; <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line"><span class="title function_ invoke__">I</span>(<span class="string">&#x27;id&#x27;</span>); &lt;==&gt; <span class="title function_ invoke__">I</span>(<span class="string">&#x27;param.id&#x27;</span>) </span><br><span class="line">param自动判断请求类型获取GET、POST或者PUT参数</span><br></pre></td></tr></table></figure><p>其他函数的用法看手册即可</p><h3 id="0x04-TP3路由格式："><a href="#0x04-TP3路由格式：" class="headerlink" title="0x04:TP3路由格式："></a>0x04:TP3路由格式：</h3><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040008353.png" alt="请添加图片描述"></p><p>这里通过一个简单的例子来了解常用的四种路由模式：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Home</span>\<span class="title class_">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hello &quot;</span>.<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>普通模式：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost/index.php?m=Home&amp;c=Index&amp;f=index&amp;name=Sn0w</span></span><br><span class="line">http:<span class="comment">//网址/index.php?m=模块名称&amp;c=控制器&amp;a=方法</span></span><br></pre></td></tr></table></figure><p><strong>兼容模式：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost/index.php?s=Home/Index/index/name/Sn0w</span></span><br><span class="line">http:<span class="comment">//网址/index.php?s=/模块/控制器/方法</span></span><br></pre></td></tr></table></figure><p><strong>REWRITE模式：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost/Home/Index/index/name/Sn0w/</span></span><br><span class="line">http:<span class="comment">//网址/模块/控制器/操作方法</span></span><br></pre></td></tr></table></figure><p><strong>PATHINFO模式：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost/index.php/Home/Index/index/name/Sn0w/</span></span><br><span class="line">http:<span class="comment">//网址/index.php/模块/控制器/操作方法</span></span><br></pre></td></tr></table></figure><p>最终呈现的效果都一样：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009021.png" alt="在这里插入图片描述"></p><h2 id="TP3-2-3-SQL注入"><a href="#TP3-2-3-SQL注入" class="headerlink" title="TP3.2.3 SQL注入"></a>TP3.2.3 SQL注入</h2><h3 id="环境搭建："><a href="#环境搭建：" class="headerlink" title="环境搭建："></a>环境搭建：</h3><p>先去官网上下载一份TP3.2.3源码，再创建一个数据库<code>thinkphp</code>和数据表<code>users</code></p><p>@<a href="https://www.thinkphp.cn/Down">https://www.thinkphp.cn/Down</a></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009886.png" alt="请添加图片描述"></p><p>添加好数据后，将数据库配置设置好</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009205.png" alt="请添加图片描述"></p><p>访问一下<code>Application</code>目录下便会自动生成目录结构，接下来将控制器给配置好</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Application/Home/Controller/IndexController.<span class="keyword">class</span>.php</span><br><span class="line"><span class="comment">#更改内容为:</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Home</span>\<span class="title class_">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> <span class="keyword">extends</span> <span class="title">Controller</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">shy</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="title function_ invoke__">M</span>(<span class="string">&#x27;users&#x27;</span>)-&gt;<span class="title function_ invoke__">find</span>(<span class="title function_ invoke__">I</span>(<span class="string">&#x27;GET.id&#x27;</span>));</span><br><span class="line">        <span class="title function_ invoke__">dump</span>(<span class="variable">$data</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试一下效果：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009696.png" alt="在这里插入图片描述"></p><p>下断点，至于如何设置<code>PHPstorm</code>调试的可以参考如下文章：</p><p>@<a href="https://blog.csdn.net/Xxy605/article/details/120973447">https://blog.csdn.net/Xxy605/article/details/120973447</a></p><p>接下来就输入正常的SQL测试语句<code>?id=1&#39; or 1=1%23</code> ，看一下传入的参数所走的流程：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009110.png" alt="在这里插入图片描述"></p><p><code>M</code>方法先实例化一个数据库操作对象，F8跳过此方法到<code>I</code>方法中，不影响传入参数的代码就不再叙述，默认的filter是<code>htmlspecialchars()</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009456.png" alt="在这里插入图片描述"></p><p>先经过<code>htmlspecialchars()</code> 的处理，此函数默认是不转义单引号的，之后再回调<code>think_filter</code>函数进行过滤</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009760.png" alt="在这里插入图片描述"></p><p>跟踪一下这个函数，是黑名单过滤，看都过滤了哪些字符</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009044.png" alt="在这里插入图片描述"></p><p>最终参数输出为</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009110.png" alt="在这里插入图片描述"></p><p><code>I</code>方法结束后，便会进入到<code>find</code>方法中去，这个方法作用是查询数据，F7跟着代码走一下，到分析表达式这块，这里调用了<code>_parseOptions()</code> 这个函数</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009435.png" alt="在这里插入图片描述"></p><p>此时id还是之前传入的<code>1&#39; or 1=1#</code> ，跟进这个函数看做了什么处理，如下图进入字段类型验证这段代码</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009660.png" alt="在这里插入图片描述"></p><p>又有一个<code>_parseType</code> 函数对我们传入的参数（即<code>$options[&#39;where&#39;]</code>）进行处理，此时id依旧是我们传入的，跟进这个函数继续看</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009758.png" alt="在这里插入图片描述"></p><p>这里的代码把我们传入的id进行了强制类型转换，使用了<code>intval</code>这个函数，到这一步我们传入的参数就变成了1，然后再返回给<code>_parseOptions()</code> 这个函数，再进行查询便不会出现SQL注入</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009923.png" alt="请添加图片描述"></p><p>梳理一下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=<span class="number">1</span><span class="string">&#x27; or 1=1# -&gt; M() -&gt; find() -&gt; _parseOptions() -&gt; _parseType()</span></span><br></pre></td></tr></table></figure><p>传入的参数便是在<code>_parseType()</code> 这个函数处被处理了，但具体是怎么处理的还是没搞清楚，因为前面创建数据库<code>id</code>列使用的是<code>int</code> 类型，所以到<code>intval</code>这个函数就会直接被处理，所以将<code>id</code>列改为<code>varchar</code>，F7继续跟进</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009571.png" alt="在这里插入图片描述"></p><p>进入<code>buildSelectSql</code> 这个函数前，传入的参数还是正常的，跟进这个函数，进入到<code>parseSql</code> 函数，作用是对原初的SQL语句进行替换，构造的<code>id</code>在<code>where</code>那里，跟进一下<code>parseWhere()</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009902.png" alt="在这里插入图片描述"></p><p>跟进到此，又发现调用了两个函数，此时传入的还是之前的 </p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009044.png" alt="在这里插入图片描述"></p><p>跟进<code>parseWhereItem</code> 这个函数，发现到这一步又调用了<code>parseValue</code> </p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009949.png" alt="在这里插入图片描述"></p><p>进行跟进看一下这个函数对传入的参数进行了什么处理</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * value分析</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@access</span> protected</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mixed $value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> string</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">parseValue</span>(<span class="params"><span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">            <span class="variable">$value</span> =  <span class="title function_ invoke__">strpos</span>(<span class="variable">$value</span>,<span class="string">&#x27;:&#x27;</span>) === <span class="number">0</span> &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$value</span>,<span class="title function_ invoke__">array_keys</span>(<span class="variable">$this</span>-&gt;bind))? <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">escapeString</span>(<span class="variable">$value</span>) : <span class="string">&#x27;\&#x27;&#x27;</span>.<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">escapeString</span>(<span class="variable">$value</span>).<span class="string">&#x27;\&#x27;&#x27;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="keyword">isset</span>(<span class="variable">$value</span>[<span class="number">0</span>]) &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$value</span>[<span class="number">0</span>]) &amp;&amp; <span class="title function_ invoke__">strtolower</span>(<span class="variable">$value</span>[<span class="number">0</span>]) == <span class="string">&#x27;exp&#x27;</span>)&#123;</span><br><span class="line">            <span class="variable">$value</span> =  <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">escapeString</span>(<span class="variable">$value</span>[<span class="number">1</span>]);</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$value</span>)) &#123;</span><br><span class="line">            <span class="variable">$value</span> =  <span class="title function_ invoke__">array_map</span>(<span class="keyword">array</span>(<span class="variable">$this</span>, <span class="string">&#x27;parseValue&#x27;</span>),<span class="variable">$value</span>);</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="title function_ invoke__">is_bool</span>(<span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="variable">$value</span> =  <span class="variable">$value</span> ? <span class="string">&#x27;1&#x27;</span> : <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(<span class="title function_ invoke__">is_null</span>(<span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="variable">$value</span> =  <span class="string">&#x27;null&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>那这就很明显了，第一个if条件判断成功，进入<code>escapeString</code> 函数，使用<code>addslashes()</code> 转义传入的单引号，后面就无需再跟进了就是拼接SQL语句</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009451.png" alt="在这里插入图片描述"></p><p>但代码中还有很多判断数组的代码，因此就要考虑一下<code>id</code>传数组，再跟进代码看一下是否存在SQL注入,最后用一张图来总结便是：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009824.png" alt="在这里插入图片描述"></p><h3 id="Thinkphp3-2-3-where注入"><a href="#Thinkphp3-2-3-where注入" class="headerlink" title="Thinkphp3.2.3 where注入"></a>Thinkphp3.2.3 where注入</h3><p><strong>Payload：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">thinkphp_3.<span class="number">2.3</span>/index.php/home/index/shy?id[where]=<span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="title function_ invoke__">updatexml</span>(<span class="number">1</span>,<span class="title function_ invoke__">concat</span>(<span class="number">0x7e</span>,(select password <span class="keyword">from</span> users limit <span class="number">1</span>),<span class="number">0x7e</span>),<span class="number">1</span>)%<span class="number">23</span></span><br></pre></td></tr></table></figure><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009721.png" alt="在这里插入图片描述"></p><p>先放出Payload，下面跟着代码看是怎么出现的这个<code>where</code> 报错注入，这次传入的参数为数组 <code>?id[where]= 1 and 1=updatexml(1,concat(0x7e,(select password from users limit 1),0x7e),1)%23</code> ，<code>I</code>方法在最后的代码会对数组参数的每个成员使用<code>think_filter</code>函数 </p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009867.png" alt="在这里插入图片描述"></p><p>刚才跟着正常的SQL测试语句知道，知道<code>think_filter</code>函数是一个黑名单，过滤了一些特殊字符，但明显过滤的不是很全，<code>updatexml、extractvalue</code> 这些报错函数都未过滤</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009039.png" alt="在这里插入图片描述"></p><p>继续跟进便进入了<code>find</code>函数到<code>_parseOptions</code> 这个函数中，在进入此函数前<code>$options</code>是</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009319.png" alt="在这里插入图片描述"></p><p>刚才正常传入的SQL测试语句只有进入到<code>_parseType()</code>后才会被<code>intval</code> 函数给强制转换，但这里这个if判断中的<code>is_array($options[&#39;where&#39;])</code>没有满足，此时的where的值不是数组</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009897.png" alt="在这里插入图片描述"></p><p>和上面正常传入的SQL测试语句对比一下，便会发现不同，最后通过此函数处理后传入的payload依旧没有变</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009594.png" alt="在这里插入图片描述"></p><p>F7继续跟进</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009656.png" alt="在这里插入图片描述"></p><p>到<code>select</code>函数后，发现<code>buildSelectSql</code> 的作用是拼接SQL语句</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009913.png" alt="在这里插入图片描述"></p><p>跟进这个函数</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009819.png" alt="在这里插入图片描述"></p><p>第一个<code>if</code>语句就是计算<code>limit</code>，这里不是重点，发现后面又调用了<code>parseSql</code> 这个函数</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009357.png" alt="在这里插入图片描述"></p><p>构造的参数是在<code>where</code> ，跟进看一下</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009408.png" alt="在这里插入图片描述"></p><p>此时的<code>$whereStr</code> 是字符串，所以就没有经过中间的代码，直接返回此语句</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009515.png" alt="在这里插入图片描述"></p><p>F7跟进就会发现最终拼接的语句便还是我们传入的，并没有被过滤掉，便导致了thinkphp3.2.3 where注入</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009669.png" alt="在这里插入图片描述"></p><p><strong>官方修补方法：</strong></p><p>@<a href="https://github.com/top-think/thinkphp/commit/9e1db19c1e455450cfebb8b573bb51ab7a1cef04">https://github.com/top-think/thinkphp/commit/9e1db19c1e455450cfebb8b573bb51ab7a1cef04</a></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009777.png" alt="在这里插入图片描述"></p><p><code>v3.2.4</code>将<code>$options</code>和<code>$this-&gt;options</code>进行了区分，从而传入的参数无法污染到<code>$this-&gt;options</code>，也就无法控制sql语句了</p><h3 id="Thinkphp3-2-3-exp注入"><a href="#Thinkphp3-2-3-exp注入" class="headerlink" title="Thinkphp3.2.3 exp注入"></a>Thinkphp3.2.3 exp注入</h3><p><strong>payload：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username[<span class="number">0</span>]=exp&amp;username[<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> <span class="title function_ invoke__">updatexml</span>(<span class="number">1</span>,<span class="title function_ invoke__">concat</span>(<span class="number">0x7e</span>,<span class="title function_ invoke__">user</span>(),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009670.png" alt="在这里插入图片描述"></p><p>把环境重新更改一下，使用全局数组进行传参，这里之所以不用<code>I</code>函数来获取参数，是因为<code>I</code>函数会回调<code>think_filter()</code>函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">think_filter</span>(<span class="params">&amp;<span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// TODO 其他安全过滤</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 过滤查询特殊字符</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(NEQ|GT|EGT|LT|ELT|OR|XOR|LIKE|NOTLIKE|NOT BETWEEN|NOTBETWEEN|BETWEEN|NOTIN|NOT IN|IN)$/i&#x27;</span>, <span class="variable">$value</span>)) &#123;</span><br><span class="line">        <span class="variable">$value</span> .= <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过滤了EXP字符串，并会在后面拼接一个空格，这个点会影响exp注入，到后面便能了解了，打上断点，先进入<code>where</code>函数中</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009605.png" alt="在这里插入图片描述"></p><p>只有最后的代码对传入的参数发挥了作用,其作用便是把数组<code>array(&#39;username&#39; =&gt; $_GET[&#39;username&#39;])</code> 传给<code>$this-&gt;options[&#39;where&#39;]</code> ，继续跟进到<code>find</code>函数，一直到<code>parseWhere()</code> 函数，观察到这一步和上面的where注入有哪些区别</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009763.png" alt="在这里插入图片描述"></p><p>传入的参数会进入到<code>parseWhereItem()</code> 函数中，而where注入的是当作字符串直接跳过了这一段代码，先判断该变量是否为数组，再判断索引为0的值是否为字符串，到下面的代码还要验证该索引值是否等于<code>exp</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009900.png" alt="在这里插入图片描述"></p><p>关键点在于下面的代码：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009166.png" alt="在这里插入图片描述"></p><p>正常来说传入的参数是字符串即<code>$val=test</code>，但这里传入了数组，<code>$exp</code> 便是<code>$val[0]</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009323.png" alt="在这里插入图片描述"></p><p>又满足了<code>elseif</code>语句（跟到这里便也能理解为什么要用超全局数组，而不用I函数了，如果使用I函数不满足条件，便会异常抛出，从而影响注入），把<code>where</code>条件直接用点拼接，这时传入</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[<span class="number">0</span>]=exp&amp;username[<span class="number">1</span>]==<span class="number">1</span> <span class="keyword">and</span> test</span><br></pre></td></tr></table></figure><p>便会造成SQL注入，最终拼接出来的语句便是</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span> users where `username`  <span class="variable">$val</span>[<span class="number">1</span>]  limit <span class="number">1</span></span><br></pre></td></tr></table></figure><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009577.png" alt="在这里插入图片描述"></p><h3 id="thinkphp3-2-3-bind注入"><a href="#thinkphp3-2-3-bind注入" class="headerlink" title="thinkphp3.2.3 bind注入"></a>thinkphp3.2.3 bind注入</h3><blockquote><p><strong>简述</strong>：由于框架实现安全数据库过程中在<code>update</code>更新数据的过程中存在SQL语句的拼接，并且当传入数组未过滤时导致出现了SQL注入</p></blockquote><p>将环境更改一下</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009554.png" alt="在这里插入图片描述"></p><p><strong>payload:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id[<span class="number">0</span>]=bind&amp;id[<span class="number">1</span>]=<span class="number">0</span> <span class="keyword">and</span> <span class="title function_ invoke__">updatexml</span>(<span class="number">1</span>,<span class="title function_ invoke__">concat</span>(<span class="number">0x7e</span>,<span class="title function_ invoke__">user</span>(),<span class="number">0x7e</span>),<span class="number">1</span>)&amp;password=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>传入参数，跟进一下代码，看一下为什么这样的<code>payload</code>能造成报错注入，跟前面几条链一样，参数会先赋值给<code>$this-&gt;options[&#39;where&#39;]</code> </p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009037.png" alt="在这里插入图片描述"></p><p>再跟进到<code>save</code>方法中去，调用<code>_parseOptions</code> 方法</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040009642.png" alt="在这里插入图片描述"></p><p>到这一步<code>$val</code> 为数组，不属于标量，所以不经过<code>_parseType</code>方法验证类型</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010811.png" alt="在这里插入图片描述"></p><p>从该方法中出来后<code>$this-&gt;options</code>赋值给 <code>$options</code> ，接下来便调用<code>$this-&gt;db-&gt;update</code>方法</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010861.png" alt="在这里插入图片描述"></p><p>在这里出现一段SQL语句和参数绑定，跟进<code>parseSet</code>这个方法查看</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010113.png" alt="在这里插入图片描述"></p><p>再跟进到<code>$this-&gt;bindParam($name,$val);</code> </p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010614.png" alt="在这里插入图片描述"></p><p>因为<code>$this-&gt;bind</code>为空，所以<code>$name</code>为0，而<code>$val</code>为1</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010551.png" alt="在这里插入图片描述"></p><p>经过此方法的处理,SQL语句便存在一个<code>:</code> 阻断了注入，最终绑定参数为：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010565.png" alt="在这里插入图片描述"></p><p>产生的SQL语句为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `users` SET `password`=:<span class="number">0</span></span><br></pre></td></tr></table></figure><p>再调用<code>parseWhereItem</code>方法拼接<code>where</code>部分处理后的语句，当<code>$exp</code>为bind时，<code>$whereStr</code>部分可控</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010810.png" alt="在这里插入图片描述"></p><p>两段SQL语句再进行合并，最终形成的SQL语句</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE `users` SET `password`=:<span class="number">0</span> WHERE `id` = :<span class="number">0</span> <span class="keyword">and</span> <span class="title function_ invoke__">updatexml</span>(<span class="number">1</span>,<span class="title function_ invoke__">concat</span>(<span class="number">0x7e</span>,<span class="title function_ invoke__">user</span>(),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>最后跟进<code>execute</code>方法，该方法中有对绑定参数的处理：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;bind))&#123;</span><br><span class="line">   <span class="variable">$that</span>   =   <span class="variable language_">$this</span>;</span><br><span class="line">   <span class="variable language_">$this</span>-&gt;queryStr =   <span class="title function_ invoke__">strtr</span>(<span class="variable">$this</span>-&gt;queryStr,<span class="title function_ invoke__">array_map</span>(function(<span class="variable">$val</span>) <span class="keyword">use</span>(<span class="variable">$that</span>)&#123; <span class="keyword">return</span> <span class="string">&#x27;\&#x27;&#x27;</span>.<span class="variable">$that</span>-&gt;<span class="title function_ invoke__">escapeString</span>(<span class="variable">$val</span>).<span class="string">&#x27;\&#x27;&#x27;</span>; &#125;,<span class="variable language_">$this</span>-&gt;bind));</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>这两行代码便是起到替换的作用，代码先是创建一个<a href="https://www.cnblogs.com/echojson/p/10957362.html">闭包</a>，调用<code>array_map</code>，对<code>$this-&gt;bind</code>这个数组中的每个参数都调用这个闭包，对<code>$this-&gt;bind</code>进行处理，未处理前为<code>array(&quot;:0&quot;=&gt;&quot;1&quot;);</code> ，处理后为：<code>array(&quot;:0&quot;=&gt;&quot;&#39;1&#39;&quot;);</code> ，最后再通过<code>strtr</code>函数处理<code>$this-&gt;queryStr</code>语句，得到的结果如下：</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010385.png" alt="在这里插入图片描述"></p><p><code>:0</code>替换为外部传进来的字符串，所以将传入参数等于0，这样就拼接了一个<code>:0</code>，然后会通过<code>strtr()</code>被替换为1，SQL语句便可以正常执行，这也就是为什么payload中<code>id[1]=0</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010797.png" alt="在这里插入图片描述"></p><p><strong>官方修复：</strong></p><p>过滤<code>bind</code>即可</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010258.png" alt="在这里插入图片描述"></p><h2 id="TP3-2-3-RCE漏洞"><a href="#TP3-2-3-RCE漏洞" class="headerlink" title="TP3.2.3 RCE漏洞"></a>TP3.2.3 RCE漏洞</h2><blockquote><p>业务代码中如果模板赋值方法assign的第一个参数可控，则可导致模板文件路径变量被覆盖为携带攻击代码的文件路径，造成任意文件包含，执行任意代码</p></blockquote><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010066.png" alt="在这里插入图片描述"></p><p>程序会进入模板渲染方法中，需要先创建对应的模板文件（<code>View</code>），模板文件位置为：<code>\Application\Home\View\Index\index.html</code> ，这里的模板渲染方法除了<code>display</code>，也可以为<code>fetch、show</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010959.png" alt="在这里插入图片描述"></p><p>但使用<code>fetch</code>会有一些区别，如上图其程序逻辑会使用到<code>ob_start()</code>打开缓冲区，所以PHP代码的数据块和<code>echo()</code>输出都会进入缓冲区而不会立刻输出，如果想要<code>fetch</code>方法对应的攻击代码输出的话，需要在攻击代码末尾带上<code>exit()</code>或<code>die()</code></p><p>Debug开启和关闭是有一些区别的，具体如下：</p><p><strong>Log记录目录：</strong></p><p>若开启debug模式日志会到：<code>\Application\Runtime\Logs\Home\</code>下</p><p>若未开启debug模式日志会到：<code>\Application\Runtime\Logs\Common\</code>下</p><p><strong>这里以Debug关闭为例（</strong><code>define(&#39;APP_DEBUG&#39;,false)</code><strong>）</strong></p><p><strong>构造请求包：</strong></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010316.png" alt="在这里插入图片描述"></p><p><strong>构造攻击请求：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./Application/Runtime/Logs/Common/<span class="number">22_08_03</span>.log</span><br></pre></td></tr></table></figure><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010855.png" alt="在这里插入图片描述"></p><p>若<code>Debug</code>开启，正确的请求日志也会被记录到日志中，只是日志路径不 一样了而已</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010429.png" alt="在这里插入图片描述"></p><p>下面跟着代码来走一遍，看看此payload如何触发文件包含导致RCE</p><p>先传入参数会先进入<code>assign</code>函数中，再赋值给<code>$this→tVar</code></p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010989.png" alt="在这里插入图片描述"></p><p>之后会进入到<code>display</code>方法中，<code>display</code>方法开始解析并获取模板文件内容，此时模板文件路径和内容为空</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010591.png" alt="在这里插入图片描述"></p><p>再进入到<code>fetch</code>方法中，此时传入的参数为空，程序会根据配置去获取默认模板文件的位置</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010364.png" alt="在这里插入图片描述"></p><p>当<code>TMPL_ENGINE_TYPE</code> 配置为<code>php</code>时，会采用PHP原生模板，默认的为<code>Think</code> ,便进入到else分支中，获取<code>$this→tVar</code>变量值赋值给<code>$params</code>，之后再进入到<code>Hook::listen</code>方法中</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010760.png" alt="请添加图片描述"></p><p>进入<code>exec</code>方法中，处理后调用<code>Behavior\ParseTemplateBehavior</code>类中的run方法处理<code>$params</code>这个带有日志文件路径的值</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010491.png" alt="请添加图片描述"></p><p>程序进入run方法中，一系列判断后，进入else分支，调用Think\Template类中的fetch方法对变量$_data（带有日志文件路径的变量值）进行处理</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010091.png" alt="请添加图片描述"></p><p>进入Think\Template类中的fetch方法，获取缓存文件路径后，再进入Storage的load方法中</p><p><img src="https://sn0w.oss-cn-shenzhen.aliyuncs.com/img/202304040010551.png" alt="在这里插入图片描述"></p><p><code>$_filename</code>为之前获取的缓存文件路径，$var则为之前带有_filename=日志文件路径的数组，$vars不为空则使用extract方法的<code>EXTR_OVERWRITE</code>默认描述对变量值进行覆盖，之后include该日志文件路径，造成文件包含，最终导致包含文件造成RCE</p><h2 id="Thinkphp3-2-3-日志泄露"><a href="#Thinkphp3-2-3-日志泄露" class="headerlink" title="Thinkphp3.2.3 日志泄露"></a>Thinkphp3.2.3 日志泄露</h2><blockquote><p>前提：开启了Debug</p></blockquote><p>THINKPHP3.2 结构：<code>Application/Runtime/Logs/Home/年份_月份_日期.log</code></p><h3 id="参考博客："><a href="#参考博客：" class="headerlink" title="参考博客："></a>参考博客：</h3><p>@<a href="https://y4er.com/post/thinkphp3-vuln/">https://y4er.com/post/thinkphp3-vuln/</a></p><p>@<a href="https://blog.csdn.net/rfrder/article/details/114024426">https://blog.csdn.net/rfrder/article/details/114024426</a></p><p>@<a href="https://www.cnblogs.com/zpchcbd/p/12552185.html">https://www.cnblogs.com/zpchcbd/p/12552185.html</a></p><p>@<a href="https://paper.seebug.org/573/">https://paper.seebug.org/573/</a></p><p>@<a href="https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ">https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ</a></p><p>@<a href="https://blog.csdn.net/Mruos/article/details/109802121">https://blog.csdn.net/Mruos/article/details/109802121</a></p><p>@<a href="https://blog.csdn.net/qq_33382313/article/details/51702787">https://blog.csdn.net/qq_33382313/article/details/51702787</a></p><p>@<a href="https://www.cnblogs.com/lingzhisec/p/15728886.html">https://www.cnblogs.com/lingzhisec/p/15728886.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> PHP代码审计 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
